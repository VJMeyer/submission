% Enhanced preamble for AMTAIR thesis
% Must be compatible with Quarto's processing

% Typography and formatting
\usepackage[protrusion=true,expansion=true]{microtype}
\usepackage{setspace}
\onehalfspacing

% Enhanced cross-referencing
\usepackage{cleveref}
\crefformat{section}{Section~#2#1#3}
\crefformat{figure}{Figure~#2#1#3}
\crefformat{table}{Table~#2#1#3}
\crefformat{equation}{Equation~#2#1#3}

% Code and verbatim support
\usepackage{fancyvrb}
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}

% Define Shaded environment for code blocks
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newenvironment{snugshade}{\begin{shaded}}{\end{shaded}}

% Callout box support using tcolorbox
\usepackage{tcolorbox}
\tcbuselibrary{skins,breakable}

% Define callout styles
\newtcolorbox{callout-note}{
  enhanced,
  breakable,
  colback=blue!5!white,
  colframe=blue!75!black,
  title=Note,
  fonttitle=\bfseries,
  attach boxed title to top left={yshift=-2mm},
  boxed title style={colback=blue!75!black}
}

\newtcolorbox{callout-tip}{
  enhanced,
  breakable,
  colback=green!5!white,
  colframe=green!75!black,
  title=Tip,
  fonttitle=\bfseries,
  attach boxed title to top left={yshift=-2mm},
  boxed title style={colback=green!75!black}
}

\newtcolorbox{callout-warning}{
  enhanced,
  breakable,
  colback=orange!5!white,
  colframe=orange!75!black,
  title=Warning,
  fonttitle=\bfseries,
  attach boxed title to top left={yshift=-2mm},
  boxed title style={colback=orange!75!black}
}

% Header and footer styling
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[LE,RO]{\slshape\nouppercase{\rightmark}}
\fancyhead[LO,RE]{\slshape\nouppercase{\leftmark}}
\fancyfoot[C]{\thepage}

% Figure and table positioning
\usepackage{float}
\floatplacement{figure}{H}
\floatplacement{table}{H}

% Enhanced list handling
\usepackage{enumitem}
\setlist[itemize]{topsep=0pt,partopsep=0pt,parsep=0pt,itemsep=2pt}
\setlist[enumerate]{topsep=0pt,partopsep=0pt,parsep=0pt,itemsep=2pt}

% Math theorem environments
\usepackage{amsthm}
\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]
\newtheorem{example}{Example}[section]
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}{Proposition}[section]

% URL formatting
\usepackage{url}
\urlstyle{same}

% Custom commands for affidavit compatibility
\newcommand{\thesistitle}{Automating the Modelling of Transformative Artificial Intelligence Risks}
\newcommand{\thesisauthor}{Valentin Jakob Meyer}